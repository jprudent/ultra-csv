<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>ultra-csv.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Ultra-csv 0.2.0 API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ultra-csv</span></div></div></li><li class="depth-2 current"><a href="ultra-csv.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="ultra-csv.core.html#var-close.21"><div class="inner"><span>close!</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-csv-line"><div class="inner"><span>csv-line</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-csv-line-reader"><div class="inner"><span>csv-line-reader</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-guess-spec"><div class="inner"><span>guess-spec</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-load-spec-str"><div class="inner"><span>load-spec-str</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-make-date-coercer"><div class="inner"><span>make-date-coercer</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-read-csv"><div class="inner"><span>read-csv</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-write-csv.21"><div class="inner"><span>write-csv!</span></div></a></li><li class="depth-1"><a href="ultra-csv.core.html#var-write-spec"><div class="inner"><span>write-spec</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">ultra-csv.core</h2><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-close.21"><h3>close!</h3><div class="usage"><code>(close! f)</code></div><div class="doc"><div class="markdown"><p>Closes and cleans the io ressources used. Can be used on a greedy generator or any line of a lazy seqs of results</p></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L380">view source</a></div></div><div class="public anchor" id="var-csv-line"><h3>csv-line</h3><div class="usage"><code>(csv-line spec data)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L699">view source</a></div></div><div class="public anchor" id="var-csv-line-reader"><h3>csv-line-reader</h3><div class="usage"><code>(csv-line-reader {:keys [header? field-names schema guess-types? strict? counter-step silent? limit nullable-fields? coercers], :or {guess-types? true, strict? true, coercers {}}, :as opts})</code></div><div class="doc"><div class="markdown"><p>This function returns a reader function that accepts inputs of one <em>String</em> line at a time. It takes the same options as <a href="ultra-csv.core.html#var-read-csv">read-csv</a> minus some processing and the file and analysis options.</p></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L489">view source</a></div></div><div class="public anchor" id="var-guess-spec"><h3>guess-spec</h3><div class="usage"><code>(guess-spec uri {:keys [header? field-names field-names-fn schema encoding guess-types? delimiter nullable-fields? keywordize-keys? sample-size bom skip], :or {guess-types? true, nullable-fields? true, sample-size 100, skip 0}, :as opts})</code><code>(guess-spec uri)</code></div><div class="doc"><div class="markdown"><p>This function takes a source of csv lines (either a <em>Reader</em>, <em>InputStream</em> or <em>String</em> URI) and tries to guess the specs necessary to parse it. You can use the option map to specify some values for the spec. Recognised options are:</p><p><em>Analysis options</em></p>
<ul>
  <li><strong>header?</strong>: Whether the file as a header on the first line</li>
  <li><strong>sample-size</strong>: number of lines on which heuristics are applied. Defaults to <em>100</em></li>
  <li><strong>guess-types?</strong>: Whether to try to guess types for each field. Defaults to <em>true</em></li>
  <li><strong>skip</strong>: Number of lines to skip before starting to parse. Defaults to 0</li>
</ul><p><em>File options</em></p>
<ul>
  <li><strong>encoding</strong>: Character encoding for the file</li>
</ul><p><em>Processing options</em></p>
<ul>
  <li><strong>field-names-fn</strong>: fn to apply to the name of each field. Defaults to trim function</li>
  <li><strong>nullable-fields?</strong>: Whether the values are optionals. Defaults to <em>true</em></li>
  <li><strong>keywordize-keys?</strong>: Whether to turn fields into keywords. Defaults to <em>true</em></li>
</ul><p><em>Format options</em></p>
<ul>
  <li><strong>delimiter</strong>: Character used as a delimiter</li>
  <li><strong>schema</strong>: Schema to validate and coerce output</li>
  <li><strong>field-names</strong>: Names for the csv fields, in order</li>
</ul></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L387">view source</a></div></div><div class="public anchor" id="var-load-spec-str"><h3>load-spec-str</h3><div class="usage"><code>(load-spec-str spec-string)</code></div><div class="doc"><div class="markdown"><p>Loads a spec structure from String form. <strong>BEWARE</strong> The uses eval on the passed String, only use on inputs that are <strong>ABSOLUTELY SAFE</strong></p></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L31">view source</a></div></div><div class="public anchor" id="var-make-date-coercer"><h3>make-date-coercer</h3><div class="usage"><code>(make-date-coercer fmt)</code><code>(make-date-coercer fmt timezone)</code></div><div class="doc"><div class="markdown"><p>Makes a date coercer to use with the <em>coercer</em> option of <a href="ultra-csv.core.html#var-read-csv">read-csv</a>. Given a formatter <em>String</em> and an optional timezonr <em>String</em>, this will return a ready to use function. Details on the format can be found at <a href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a></p></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L125">view source</a></div></div><div class="public anchor" id="var-read-csv"><h3>read-csv</h3><div class="usage"><code>(read-csv uri {:keys [header? field-names field-names-fn schema encoding guess-types? strict? greedy? counter-step silent? limit skip-analysis? nullable-fields? keywordize-keys? coercers bom skip], :or {guess-types? true, strict? true, nullable-fields? true, keywordize-keys? true, coercers {}, skip 0}, :as opts})</code><code>(read-csv uri)</code></div><div class="doc"><div class="markdown"><p>This function takes a source of csv lines (either a <em>Reader</em>, <em>InputStream</em> or <em>String</em> URI) and returns the parsed results. If headers are found on the file or <em>field-names</em> where given as options, it will return a collection of one map per line, associating each field name with its value. If not, one vector will be returned for each line, in order.</p><p>You can use the option map to specify some values for the spec. Recognised options are:</p><p><em>Analysis options</em></p>
<ul>
  <li><strong>header?</strong>: Whether the file as a header on the first line</li>
  <li><strong>sample-size</strong>: number of lines on which heuristics are applied. Defaults to <em>100</em></li>
  <li><strong>guess-types?</strong>: Whether to try to guess types for each field. Defaults to <em>true</em></li>
  <li><strong>skip-analysis?</strong>: Whether to completely bypass analysis and only use spec  Defaults to <em>false</em></li>
  <li><strong>skip</strong>: Number of lines to skip before starting to parse. Defaults to 0</li>
</ul><p><em>Processing options</em></p>
<ul>
  <li><strong>greedy?</strong>: If true returns a function that can be used as a generator, returning one line  with each call, else returns a lazy seq of lines. Defaults to <em>false</em></li>
  <li><strong>strict?</strong>: Whether to throw exception on reading of validation error, or just skip it.  Defaults to <em>true</em></li>
  <li><strong>silent?</strong>: Whether there should be error messages emitted on <em>stderr</em> when skipping Exceptions.  Defaults to <em>false</em></li>
  <li><strong>limit</strong>: Closes and cleans the io ressources after reading this many lines. Useful for  sampling</li>
  <li><strong>field-names-fn</strong>: fn to apply to the name of each field. Can be used to sanitize header  names. Defaults to trim function</li>
  <li><strong>nullable-fields?</strong>: Whether the values are optionals. Defaults to <em>true</em></li>
  <li><strong>keywordize-keys?</strong>: Whether to turn fields into keywords. Defaults to <em>true</em></li>
</ul><p><em>Format options</em></p>
<ul>
  <li><strong>delimiter</strong>: Character used as a delimiter</li>
  <li><strong>schema</strong>: Schema to validate and coerce output</li>
  <li><p><strong>coercers</strong>: A map associating a type as key with a function from <em>String</em> to that type.  For example:</p><p>{:coercers {java.util.Date (make-date-coercer &ldquo;yyyyMMdd&rdquo;)}}</p></li>
  <li><p><strong>field-names</strong>: Names for the csv fields, in order</p></li>
</ul></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L519">view source</a></div></div><div class="public anchor" id="var-write-csv.21"><h3>write-csv!</h3><div class="usage"><code>(write-csv! uri {:keys [bom encoding field-names coercers header? append], :as spec, :or {bom :none, header? true}} data)</code><code>(write-csv! uri data)</code></div><div class="doc"><div class="markdown"><p>This function takes a target (either a <em>Reader</em>, <em>InputStream</em> or <em>String</em> URI), a spec of options and a seq of either <em>maps</em> or <em>seqs</em>. Each data structure is written to the target csv as a single line.</p><p>Right now, custom encoders are ignored and each value is just coerced to its <em>String</em> format.</p><p>The option map is the same as <a href="ultra-csv.core.html#var-read-csv">read-csv</a> with these added options:</p><p><em>Write options</em></p>
<ul>
  <li><strong>append</strong>: if set to true, opens the given uri in append mode. <em>header?</em> option is then  ignored.</li>
</ul></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L650">view source</a></div></div><div class="public anchor" id="var-write-spec"><h3>write-spec</h3><div class="usage"><code>(write-spec spec)</code></div><div class="doc"><div class="markdown"><p>Writes a spec struct to a String</p></div></div><div class="src-link"><a href="http://github.com/ngrunwald/ultra-csv/blob/master/src/ultra_csv/core.clj#L26">view source</a></div></div></div></body></html>